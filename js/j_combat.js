
var allEnemies = {"friend":[{"id":"504129532","name":"Vibhor Jain","profilepic":"https://graph.facebook.com/504129532/picture","stats":[84,66,50]},{"id":"505392429","name":"Jack So","profilepic":"https://graph.facebook.com/505392429/picture","stats":[83,58,59]},{"id":"528619342","name":"Zeno Hao","profilepic":"https://graph.facebook.com/528619342/picture","stats":[73,72,55]},{"id":"529236918","name":"Lenny Khodel","profilepic":"https://graph.facebook.com/529236918/picture","stats":[74,70,56]},{"id":"529272932","name":"Alexis Castellanos","profilepic":"https://graph.facebook.com/529272932/picture","stats":[62,70,68]},{"id":"530432238","name":"Jason Lee","profilepic":"https://graph.facebook.com/530432238/picture","stats":[86,68,46]},{"id":"532264270","name":"Theodore Lau","profilepic":"https://graph.facebook.com/532264270/picture","stats":[76,80,44]},{"id":"536779015","name":"Calvin Tan","profilepic":"https://graph.facebook.com/536779015/picture","stats":[57,72,71]},{"id":"540423053","name":"Rufus Bob Cat","profilepic":"https://graph.facebook.com/540423053/picture","stats":[72,76,52]},{"id":"544599414","name":"Donald Quach","profilepic":"https://graph.facebook.com/544599414/picture","stats":[71,73,56]},{"id":"549182017","name":"Patrick Thavornkant","profilepic":"https://graph.facebook.com/549182017/picture","stats":[50,78,72]},{"id":"549484337","name":"Kathy Nguyen","profilepic":"https://graph.facebook.com/549484337/picture","stats":[80,70,50]},{"id":"550229419","name":"Jeanette Qi","profilepic":"https://graph.facebook.com/550229419/picture","stats":[64,64,72]},{"id":"560448394","name":"Alison Sunahara","profilepic":"https://graph.facebook.com/560448394/picture","stats":[76,60,64]},{"id":"561470319","name":"Kevin Song","profilepic":"https://graph.facebook.com/561470319/picture","stats":[86,60,54]},{"id":"583931587","name":"Shirley Phung","profilepic":"https://graph.facebook.com/583931587/picture","stats":[76,68,56]},{"id":"585376450","name":"Haik Stepanian","profilepic":"https://graph.facebook.com/585376450/picture","stats":[78,54,68]},{"id":"595976489","name":"Lisa Huang","profilepic":"https://graph.facebook.com/595976489/picture","stats":[75,74,51]},{"id":"596802673","name":"Janell Chang","profilepic":"https://graph.facebook.com/596802673/picture","stats":[86,62,52]},{"id":"604704074","name":"Nicole Giddings","profilepic":"https://graph.facebook.com/604704074/picture","stats":[50,76,74]},{"id":"616877994","name":"Fred Knutson","profilepic":"https://graph.facebook.com/616877994/picture","stats":[67,75,58]},{"id":"618748095","name":"Ronnie Aviv","profilepic":"https://graph.facebook.com/618748095/picture","stats":[70,82,48]},{"id":"618888977","name":"Tyler Deng","profilepic":"https://graph.facebook.com/618888977/picture","stats":[62,86,52]},{"id":"633461592","name":"Tiffanie Ly","profilepic":"https://graph.facebook.com/633461592/picture","stats":[68,74,58]},{"id":"633825301","name":"Noor Ahmad","profilepic":"https://graph.facebook.com/633825301/picture","stats":[60,67,73]},{"id":"634595875","name":"Lawrence Lam","profilepic":"https://graph.facebook.com/634595875/picture","stats":[68,78,54]},{"id":"638007238","name":"Anita Tran","profilepic":"https://graph.facebook.com/638007238/picture","stats":[64,82,54]},{"id":"643125661","name":"Stanley Cheng","profilepic":"https://graph.facebook.com/643125661/picture","stats":[78,80,42]},{"id":"659717544","name":"Katie Sunahara","profilepic":"https://graph.facebook.com/659717544/picture","stats":[68,54,78]},{"id":"664820750","name":"Jeffrey Tam","profilepic":"https://graph.facebook.com/664820750/picture","stats":[63,66,71]},{"id":"666822366","name":"James Gallier","profilepic":"https://graph.facebook.com/666822366/picture","stats":[68,80,52]},{"id":"672784166","name":"Lily Nguyen","profilepic":"https://graph.facebook.com/672784166/picture","stats":[84,84,32]},{"id":"675603326","name":"Tiffany Chang","profilepic":"https://graph.facebook.com/675603326/picture","stats":[84,74,42]},{"id":"693437778","name":"Melissa Wong","profilepic":"https://graph.facebook.com/693437778/picture","stats":[61,67,72]},{"id":"701215896","name":"William Gao","profilepic":"https://graph.facebook.com/701215896/picture","stats":[80,56,64]},{"id":"706139729","name":"Adol Christin","profilepic":"https://graph.facebook.com/706139729/picture","stats":[64,80,56]},{"id":"710932153","name":"Alex Kuznetsov","profilepic":"https://graph.facebook.com/710932153/picture","stats":[70,84,46]},{"id":"711472575","name":"Andrew Ibarra","profilepic":"https://graph.facebook.com/711472575/picture","stats":[84,74,42]},{"id":"713266575","name":"Salvador Gonzalez Garcia","profilepic":"https://graph.facebook.com/713266575/picture","stats":[54,72,74]},{"id":"727222415","name":"Anthony Popelar","profilepic":"https://graph.facebook.com/727222415/picture","stats":[55,47,98]},{"id":"730881409","name":"Michael Gondi","profilepic":"https://graph.facebook.com/730881409/picture","stats":[50,78,72]},{"id":"735521214","name":"Carol A. Paredes","profilepic":"https://graph.facebook.com/735521214/picture","stats":[84,64,52]},{"id":"742541482","name":"Patrick Chuong","profilepic":"https://graph.facebook.com/742541482/picture","stats":[78,66,56]},{"id":"792009719","name":"Sam Khuu","profilepic":"https://graph.facebook.com/792009719/picture","stats":[80,56,64]},{"id":"803454791","name":"Theresa Gannon","profilepic":"https://graph.facebook.com/803454791/picture","stats":[50,80,70]},{"id":"828400639","name":"Brenda Wong","profilepic":"https://graph.facebook.com/828400639/picture","stats":[73,59,68]},{"id":"1012710703","name":"Victor Chen","profilepic":"https://graph.facebook.com/1012710703/picture","stats":[52,59,89]},{"id":"1025430680","name":"John Dandan","profilepic":"https://graph.facebook.com/1025430680/picture","stats":[56,53,91]},{"id":"1038900137","name":"Markus Kantarci","profilepic":"https://graph.facebook.com/1038900137/picture","stats":[68,84,48]},{"id":"1054680207","name":"Chris Chew","profilepic":"https://graph.facebook.com/1054680207/picture","stats":[58,77,65]},{"id":"1055040472","name":"Joanna Luo","profilepic":"https://graph.facebook.com/1055040472/picture","stats":[74,76,50]},{"id":"1056330121","name":"Rachelle Boyson","profilepic":"https://graph.facebook.com/1056330121/picture","stats":[66,84,50]},{"id":"1060620661","name":"Angela Chen","profilepic":"https://graph.facebook.com/1060620661/picture","stats":[76,70,54]},{"id":"1064512508","name":"Kalvin Ogbuefi","profilepic":"https://graph.facebook.com/1064512508/picture","stats":[58,76,66]},{"id":"1089245654","name":"Danny Tran","profilepic":"https://graph.facebook.com/1089245654/picture","stats":[68,57,75]},{"id":"1107982767","name":"Eunice Liu","profilepic":"https://graph.facebook.com/1107982767/picture","stats":[50,54,96]},{"id":"1119183864","name":"Ashley Matthews","profilepic":"https://graph.facebook.com/1119183864/picture","stats":[75,66,59]},{"id":"1122811137","name":"Steven Kalani Bustamante","profilepic":"https://graph.facebook.com/1122811137/picture","stats":[80,60,60]},{"id":"1153918752","name":"Eric Lauffenburger","profilepic":"https://graph.facebook.com/1153918752/picture","stats":[84,84,32]},{"id":"1171039131","name":"Harry Cramer","profilepic":"https://graph.facebook.com/1171039131/picture","stats":[83,61,56]},{"id":"1180464899","name":"Yi Lu","profilepic":"https://graph.facebook.com/1180464899/picture","stats":[76,68,56]},{"id":"1184371770","name":"Brian Villanueva","profilepic":"https://graph.facebook.com/1184371770/picture","stats":[68,72,60]},{"id":"1187777509","name":"Elton Wong","profilepic":"https://graph.facebook.com/1187777509/picture","stats":[78,58,64]},{"id":"1199680173","name":"Yong Chen","profilepic":"https://graph.facebook.com/1199680173/picture","stats":[56,78,66]},{"id":"1219659302","name":"Joana Marie Juan","profilepic":"https://graph.facebook.com/1219659302/picture","stats":[86,52,62]},{"id":"1262745239","name":"Joe Wonohadidjojo","profilepic":"https://graph.facebook.com/1262745239/picture","stats":[66,68,66]},{"id":"1282562545","name":"Peter Hall","profilepic":"https://graph.facebook.com/1282562545/picture","stats":[58,48,94]},{"id":"1285570190","name":"Christopher Fong","profilepic":"https://graph.facebook.com/1285570190/picture","stats":[78,57,65]},{"id":"1313867009","name":"Katy Baecker","profilepic":"https://graph.facebook.com/1313867009/picture","stats":[50,84,66]},{"id":"1343161857","name":"Mark Edoria","profilepic":"https://graph.facebook.com/1343161857/picture","stats":[72,70,58]},{"id":"1353505190","name":"Young Hi Townsend","profilepic":"https://graph.facebook.com/1353505190/picture","stats":[52,80,68]},{"id":"1359733972","name":"Daniel Treen","profilepic":"https://graph.facebook.com/1359733972/picture","stats":[64,68,68]},{"id":"1368806778","name":"Mohsen Farhadloo","profilepic":"https://graph.facebook.com/1368806778/picture","stats":[76,60,64]},{"id":"1374201486","name":"Joseph Dones","profilepic":"https://graph.facebook.com/1374201486/picture","stats":[52,80,68]},{"id":"1386302974","name":"Salvador Chavez Garcia","profilepic":"https://graph.facebook.com/1386302974/picture","stats":[60,82,58]},{"id":"1387146237","name":"Michael Gopez","profilepic":"https://graph.facebook.com/1387146237/picture","stats":[62,84,54]},{"id":"1406065770","name":"Patrick Gannon","profilepic":"https://graph.facebook.com/1406065770/picture","stats":[68,84,48]},{"id":"1415199827","name":"Joey Knudsen","profilepic":"https://graph.facebook.com/1415199827/picture","stats":[86,86,28]},{"id":"1417295863","name":"Sagir Kadiwala","profilepic":"https://graph.facebook.com/1417295863/picture","stats":[52,76,72]},{"id":"1419493028","name":"Cathy Burnett Gannon","profilepic":"https://graph.facebook.com/1419493028/picture","stats":[86,60,54]},{"id":"1423347994","name":"Ruben Garcia","profilepic":"https://graph.facebook.com/1423347994/picture","stats":[68,78,54]},{"id":"1446092451","name":"Daniel Winkler","profilepic":"https://graph.facebook.com/1446092451/picture","stats":[56,70,74]},{"id":"1457161445","name":"Marisol Prado","profilepic":"https://graph.facebook.com/1457161445/picture","stats":[62,68,70]},{"id":"1464667069","name":"Ronnel Yabut","profilepic":"https://graph.facebook.com/1464667069/picture","stats":[76,57,67]},{"id":"1494425688","name":"Sydney Bella Lustig","profilepic":"https://graph.facebook.com/1494425688/picture","stats":[63,65,72]},{"id":"1519785377","name":"Darrel Justo","profilepic":"https://graph.facebook.com/1519785377/picture","stats":[59,90,51]},{"id":"1529048878","name":"Pramit Kumar","profilepic":"https://graph.facebook.com/1529048878/picture","stats":[78,50,72]},{"id":"1538233181","name":"Alexander Benevides","profilepic":"https://graph.facebook.com/1538233181/picture","stats":[64,84,52]},{"id":"1547477306","name":"Richard Buettner","profilepic":"https://graph.facebook.com/1547477306/picture","stats":[53,51,96]},{"id":"1607783374","name":"Kian Bradley","profilepic":"https://graph.facebook.com/1607783374/picture","stats":[70,84,46]},{"id":"1644931677","name":"Raj Dhillon","profilepic":"https://graph.facebook.com/1644931677/picture","stats":[60,70,70]},{"id":"1653335184","name":"Matthew Bucci","profilepic":"https://graph.facebook.com/1653335184/picture","stats":[57,56,87]},{"id":"1666326663","name":"Janelle Villanueva","profilepic":"https://graph.facebook.com/1666326663/picture","stats":[64,62,74]},{"id":"1681946088","name":"uae40ud558ub098ub8e8","profilepic":"https://graph.facebook.com/1681946088/picture","stats":[54,56,90]},{"id":"1761320659","name":"Courtney Nickell","profilepic":"https://graph.facebook.com/1761320659/picture","stats":[72,64,64]},{"id":"1769341587","name":"Debby Lee","profilepic":"https://graph.facebook.com/1769341587/picture","stats":[66,73,61]},{"id":"1785968712","name":"Uyen Tran","profilepic":"https://graph.facebook.com/1785968712/picture","stats":[62,76,62]},{"id":"1796190069","name":"Felix To","profilepic":"https://graph.facebook.com/1796190069/picture","stats":[65,74,61]},{"id":"1841265123","name":"Josh Kreek","profilepic":"https://graph.facebook.com/1841265123/picture","stats":[63,63,74]},{"id":"100000008103182","name":"Bill Hiddleson","profilepic":"https://graph.facebook.com/100000008103182/picture","stats":[60,80,60]},{"id":"100000028100815","name":"Carlos Perez","profilepic":"https://graph.facebook.com/100000028100815/picture","stats":[60,73,67]},{"id":"100000064030535","name":"Immanuel Dizon","profilepic":"https://graph.facebook.com/100000064030535/picture","stats":[64,86,50]},{"id":"100000103360767","name":"Danielle Klein","profilepic":"https://graph.facebook.com/100000103360767/picture","stats":[78,80,42]},{"id":"100000117790812","name":"Tuan Ho","profilepic":"https://graph.facebook.com/100000117790812/picture","stats":[68,84,48]},{"id":"100000124960772","name":"Eva Lam","profilepic":"https://graph.facebook.com/100000124960772/picture","stats":[86,48,66]},{"id":"100000170349684","name":"Robert Hewitt","profilepic":"https://graph.facebook.com/100000170349684/picture","stats":[70,70,60]},{"id":"100000202312331","name":"Myles Farquharson","profilepic":"https://graph.facebook.com/100000202312331/picture","stats":[64,86,50]},{"id":"100000260666937","name":"Stephen Tam","profilepic":"https://graph.facebook.com/100000260666937/picture","stats":[78,84,38]},{"id":"100000272372953","name":"Jennifer Guerrero","profilepic":"https://graph.facebook.com/100000272372953/picture","stats":[64,61,75]},{"id":"100000294334490","name":"Angelina Michelle","profilepic":"https://graph.facebook.com/100000294334490/picture","stats":[70,82,48]},{"id":"100000296242376","name":"David Alan","profilepic":"https://graph.facebook.com/100000296242376/picture","stats":[82,48,70]},{"id":"100000302247015","name":"Tyler Bennett","profilepic":"https://graph.facebook.com/100000302247015/picture","stats":[69,55,76]},{"id":"100000302760583","name":"Charlie Lath","profilepic":"https://graph.facebook.com/100000302760583/picture","stats":[86,62,52]},{"id":"100000342066630","name":"Alex Bennett","profilepic":"https://graph.facebook.com/100000342066630/picture","stats":[61,58,81]},{"id":"100000357737037","name":"Robbie Reekes","profilepic":"https://graph.facebook.com/100000357737037/picture","stats":[86,68,46]},{"id":"100000367110623","name":"Andrew Smith","profilepic":"https://graph.facebook.com/100000367110623/picture","stats":[78,76,46]},{"id":"100000374700252","name":"Edwin Martinez","profilepic":"https://graph.facebook.com/100000374700252/picture","stats":[74,72,54]},{"id":"100000380841009","name":"Danny Colhour","profilepic":"https://graph.facebook.com/100000380841009/picture","stats":[72,76,52]},{"id":"100000402702035","name":"Rafael Guevara","profilepic":"https://graph.facebook.com/100000402702035/picture","stats":[74,68,58]},{"id":"100000416126137","name":"Taeryn Arakawa","profilepic":"https://graph.facebook.com/100000416126137/picture","stats":[66,74,60]},{"id":"100000422272101","name":"Jizelle Uyeki","profilepic":"https://graph.facebook.com/100000422272101/picture","stats":[73,74,53]},{"id":"100000431482409","name":"Enrick Waitforit Calalang","profilepic":"https://graph.facebook.com/100000431482409/picture","stats":[75,55,70]},{"id":"100000441467248","name":"Gabino Franco","profilepic":"https://graph.facebook.com/100000441467248/picture","stats":[62,82,56]},{"id":"100000445449509","name":"Maribel Morales","profilepic":"https://graph.facebook.com/100000445449509/picture","stats":[68,78,54]},{"id":"100000463046702","name":"Asdruval Ramirez","profilepic":"https://graph.facebook.com/100000463046702/picture","stats":[86,80,34]},{"id":"100000465442422","name":"Gigi Bamsch","profilepic":"https://graph.facebook.com/100000465442422/picture","stats":[78,60,62]},{"id":"100000472278508","name":"Andrew Zhang","profilepic":"https://graph.facebook.com/100000472278508/picture","stats":[84,82,34]},{"id":"100000476844422","name":"Natalie Bamsch","profilepic":"https://graph.facebook.com/100000476844422/picture","stats":[52,82,66]},{"id":"100000484074548","name":"Garret Bamsch","profilepic":"https://graph.facebook.com/100000484074548/picture","stats":[62,86,52]},{"id":"100000557161477","name":"Justin Wong","profilepic":"https://graph.facebook.com/100000557161477/picture","stats":[72,78,50]},{"id":"100000575421871","name":"Kingsley Andersen","profilepic":"https://graph.facebook.com/100000575421871/picture","stats":[69,66,65]},{"id":"100000576206402","name":"Robert Ayala","profilepic":"https://graph.facebook.com/100000576206402/picture","stats":[78,60,62]},{"id":"100000587262264","name":"Lacey Farquharson","profilepic":"https://graph.facebook.com/100000587262264/picture","stats":[80,60,60]},{"id":"100000597200633","name":"Eric Bamsch","profilepic":"https://graph.facebook.com/100000597200633/picture","stats":[80,66,54]},{"id":"100000637915614","name":"Andi Lindblom","profilepic":"https://graph.facebook.com/100000637915614/picture","stats":[74,56,70]},{"id":"100000713456483","name":"John Ho","profilepic":"https://graph.facebook.com/100000713456483/picture","stats":[71,63,66]},{"id":"100000769775186","name":"Jorge Carrillo","profilepic":"https://graph.facebook.com/100000769775186/picture","stats":[82,70,48]},{"id":"100000844915397","name":"Cherrylyn Cruzat","profilepic":"https://graph.facebook.com/100000844915397/picture","stats":[62,73,65]},{"id":"100000909890462","name":"Stephen Huang","profilepic":"https://graph.facebook.com/100000909890462/picture","stats":[58,61,81]},{"id":"100001030852071","name":"Scott Martin Jr.","profilepic":"https://graph.facebook.com/100001030852071/picture","stats":[76,64,60]},{"id":"100001042159157","name":"Robinson Nguyen","profilepic":"https://graph.facebook.com/100001042159157/picture","stats":[86,62,52]},{"id":"100001078913701","name":"Juan Pena","profilepic":"https://graph.facebook.com/100001078913701/picture","stats":[74,78,48]},{"id":"100001101679630","name":"Tom Gannon","profilepic":"https://graph.facebook.com/100001101679630/picture","stats":[55,47,98]},{"id":"100001120252560","name":"Bryan Garduno","profilepic":"https://graph.facebook.com/100001120252560/picture","stats":[60,78,62]},{"id":"100001124568780","name":"Veronica A. Zermeu00f1o","profilepic":"https://graph.facebook.com/100001124568780/picture","stats":[73,63,64]},{"id":"100001175004886","name":"Llesica S. Hernandez","profilepic":"https://graph.facebook.com/100001175004886/picture","stats":[57,76,67]},{"id":"100001178685843","name":"Zachary Michaels","profilepic":"https://graph.facebook.com/100001178685843/picture","stats":[78,68,54]},{"id":"100001201640404","name":"Javi Vargas","profilepic":"https://graph.facebook.com/100001201640404/picture","stats":[50,86,64]},{"id":"100001235043276","name":"Kamal Homran","profilepic":"https://graph.facebook.com/100001235043276/picture","stats":[80,46,74]},{"id":"100001270053856","name":"Josselyn Lopez Julian","profilepic":"https://graph.facebook.com/100001270053856/picture","stats":[81,56,63]},{"id":"100001289881024","name":"Stephen Pangburn","profilepic":"https://graph.facebook.com/100001289881024/picture","stats":[86,52,62]},{"id":"100001563824750","name":"Zachary Cothren","profilepic":"https://graph.facebook.com/100001563824750/picture","stats":[78,52,70]},{"id":"100001861240017","name":"Carlos Hernandez","profilepic":"https://graph.facebook.com/100001861240017/picture","stats":[85,56,59]},{"id":"100001905824020","name":"Dani Pryor","profilepic":"https://graph.facebook.com/100001905824020/picture","stats":[73,60,67]},{"id":"100002127075730","name":"Wyatt Stevens","profilepic":"https://graph.facebook.com/100002127075730/picture","stats":[48,82,70]},{"id":"100002240306892","name":"Nolan Fisher","profilepic":"https://graph.facebook.com/100002240306892/picture","stats":[82,48,70]},{"id":"100002344083222","name":"Daniel Lopez","profilepic":"https://graph.facebook.com/100002344083222/picture","stats":[86,56,58]},{"id":"100002441334148","name":"Panic Stevenson","profilepic":"https://graph.facebook.com/100002441334148/picture","stats":[82,64,54]},{"id":"100002469916995","name":"Kenneth Lai","profilepic":"https://graph.facebook.com/100002469916995/picture","stats":[66,86,48]},{"id":"100002484647366","name":"Jimmy Huynh","profilepic":"https://graph.facebook.com/100002484647366/picture","stats":[76,54,70]},{"id":"100002522407754","name":"Danielle Fernandes","profilepic":"https://graph.facebook.com/100002522407754/picture","stats":[78,57,65]},{"id":"100002526015327","name":"Michelle Rojo","profilepic":"https://graph.facebook.com/100002526015327/picture","stats":[60,78,62]},{"id":"100002548851017","name":"Benjamin Nicholas Aedo","profilepic":"https://graph.facebook.com/100002548851017/picture","stats":[59,70,71]},{"id":"100002703422845","name":"Alex Chan","profilepic":"https://graph.facebook.com/100002703422845/picture","stats":[50,84,66]},{"id":"100002803586001","name":"Koshik Samota","profilepic":"https://graph.facebook.com/100002803586001/picture","stats":[72,68,60]},{"id":"100002827527734","name":"Chiraag Prafullchandra","profilepic":"https://graph.facebook.com/100002827527734/picture","stats":[68,86,46]},{"id":"100002892218048","name":"Spencer Hirasawa","profilepic":"https://graph.facebook.com/100002892218048/picture","stats":[74,76,50]},{"id":"100003002678772","name":"Mark Lester Salvador","profilepic":"https://graph.facebook.com/100003002678772/picture","stats":[60,80,60]},{"id":"100003484872262","name":"Jessica Rivas","profilepic":"https://graph.facebook.com/100003484872262/picture","stats":[62,64,74]},{"id":"100003819222906","name":"Peter Becich","profilepic":"https://graph.facebook.com/100003819222906/picture","stats":[74,57,69]},{"id":"100004030797099","name":"Studentsfirst UC Merced","profilepic":"https://graph.facebook.com/100004030797099/picture","stats":[66,74,60]},{"id":"100004178466464","name":"Joanna Yung","profilepic":"https://graph.facebook.com/100004178466464/picture","stats":[70,62,68]},{"id":"100004367022827","name":"Swa Gilishious","profilepic":"https://graph.facebook.com/100004367022827/picture","stats":[57,52,91]},{"id":"100004453654445","name":"Ashley Matthews","profilepic":"https://graph.facebook.com/100004453654445/picture","stats":[82,57,61]},{"id":"100005440564504","name":"Dinesh Lincoln","profilepic":"https://graph.facebook.com/100005440564504/picture","stats":[61,61,78]},{"id":"100006185673657","name":"Alex Sanchez","profilepic":"https://graph.facebook.com/100006185673657/picture","stats":[86,57,57]}],"result":"success"}

var enemy;

var playerX = 365;
var enemyX = 200;

var abilCooldown = 0;
var battleY = 140;

//Battle stat bonuses. set to 0 at start
var statBonus = [0, 0, 0, 0, 0];

var attackButton;
var abilityButton;
var itemButtons = new Array();

function seconds() {
	return new Date().getTime() / 1000;
}

//These values change during battle
var playerTurn = true;
//Types:
// 0 means projectile going towards player
// 1 means projectile going towards enemy
// 2 means effect running for the duration
// 3 means do shake effect
// 4 means nothing
var curMove = {
	//The various types of current moves
	type : 3,
	runningSprite : null,
	endTime : 0,
	//At the end of the current effect do the shake
	//effect
	doShake : false,
	
	//If effectsEnemy is true, damageAtEnd/healthAtEnd effects enemy
	//else effects player
	effectsEnemy : true,
	damageAtEnd : 0,
	healthAtEnd : 0,
};

//Used to store combat sprites
var comPlayer;
var comEnemy;
var comEffect;

var abilities = [
	{id: 0,name: "XSite Scripting Attack"},
	{id: 1,name: "MySQL Injection"},
	{id: 2,name: "Request More 'Pop'"}
];

//Calculates def,atk,hp,spattack from an array of str,agi,int
function calcDerivedStats(stats) {
	var der = new Array();
	der[0] = stats[1]*.5+10;
	der[1] = stats[0]*.6+stats[1]*.6+stats[2]*.6;
	//der[1] *= 1.3;
	der[2] = stats[0]*3+100;
	der[3] = stats[2]*.5+10;
	return der;
}

function startAttack(isEnemyAttack,damageToDo) {
	curMove.type = 0;
//	curMove.runningSprite = 
}

function updateStats(entity,stats) {
	derivedStats = calcDerivedStats(stats);
	entity.str = stats[0];
	entity.agi = stats[1];
	entity.int = stats[2];
	entity.def = derivedStats[0];
	entity.atk = derivedStats[1];
	entity.maxhp = derivedStats[2];
	entity.sp = derivedStats[3];
}


function genEnemy(id) {
	var f = allEnemies.friend[id];
	var enemy = new Object();
	var enemyStats = [];
	
	enemyui.leveltext.text = "Level " + lvlFromXp(userData.xp);
	
	//Modify stats based off of level
	var factor = 1+(lvlFromXp(userData.xp)-8)*.25;	//.50 seems balanced. greater = easier
	console.log("factor is " + factor);
	//Apply factor
	for (var i = 0; i < 3; i++)
		enemyStats[i] = f.stats[i]*factor;
	
	updateStats(enemy,enemyStats);
	
	if (enemy.atk < 10)
		enemy.atk = 10;
	
	enemy.health = enemy.maxhp;
	enemy.ability = Math.floor(4*Math.random());
	return enemy;
}

var pcombatui = new Object();

function showCombatUi(show) {
	abilityButton.Visible(show && (abilCooldown <= 0));	
	
	attackButton.Visible(show);
	for (var i = 0; i < itemButtons.length; i++) {
		itemButtons[i].Visible(show);
	}
}

/*
// 0 means projectile going towards player
	// 1 means projectile going towards enemy
	// 2 means effect running for the duration
	// 3 means do shake effect
	// 4 means nothing
	// 5 means item effect
	var curMove = {
		//The various types of current moves
		type : 1,
		runningSprite : comEffect,
		endTime : seconds()+2,
		//At the end of the current effect do the shake
		//effect
		doShake : true,
		
		//If effectsEnemy is true, damageAtEnd/healthAtEnd effects enemy
		//else effects player
		effectsEnemy : true,
		damageAtEnd : user.stats.sp,
		healthAtEnd : 0,
 */

var lastUpdateAt = 0;
function updateCombat() {
	userData.health = Math.max(Math.min(userData.health,user.stats.maxhp),0);
	
	//Update displays
	var stu = enemy.health/enemy.maxhp*100;
	enemyui.healthbar.graphics.beginFill("#000000").drawRect(0,0,100,20);
	enemyui.healthbar.graphics.beginFill("#00FF00").drawRect(0,0,stu,20);
	enemyui.healthtext.text = "" + Math.floor(enemy.health) + "/" + Math.floor(enemy.maxhp);
	
	
	//Update game logic
	var now = seconds();
	var delta = now-lastUpdateAt;
	lastUpdateAt = now;
	if (curMove.type == 1) {
		if (curMove.effectsEnemy)
			curMove.runningSprite.x -= delta*260;
		else
			curMove.runningSprite.x += delta*260;
	}
	else if (curMove.type == 3) {
		if (curMove.effectsEnemy){
			var size = comEnemy.getBounds();
			comEnemy.setTransform(enemyX+Math.random()*5,battleY+Math.random()*5,50/size.width,50/size.height);
		}
		else {
			var size = comPlayer.getBounds();
			comPlayer.setTransform(playerX+Math.random()*5,battleY+Math.random()*5,50/size.width,50/size.height);
		}
			
	}
	else if (curMove.type == 5) {
		curMove.runningSprite.scale -= 2*delta;
		curMove.runningSprite.setTransform(playerX,battleY,curMove.runningSprite.scale,curMove.runningSprite.scale)	
	}
	if (curMove.type != 4) {
		if (seconds() > curMove.endTime) {
			//Apply effect
			if (!curMove.effectsEnemy) {
				var dmg = Math.max(0,curMove.damageAtEnd-Math.floor(curMove.damageAtEnd*user.stats.def/100));
				//console.log("dmg: " + dmg + " " + curMove.damageAtEnd + " " + curMove.damageAtEnd*user.stats.def/100);
				
				userData.health -= dmg;
				//console.log("dmg is " + dmg);
				userData.health += curMove.healthAtEnd;
			}
			else {
				enemy.health -= Math.max(0,curMove.damageAtEnd-Math.floor(curMove.damageAtEnd*enemy.def/100));
				enemy.health += curMove.healthAtEnd;
				if (enemy.health < 0)
					enemy.health = 0; 
			}
			
			curMove.damageAtEnd = curMove.healthAtEnd = 0;
			
			//Reset position
			var size = comPlayer.getBounds(); 
			comPlayer.setTransform(playerX,battleY,50/size.width,50/size.height);
			size = comEnemy.getBounds();
			comEnemy.setTransform(enemyX,battleY,50/size.width,50/size.height);
			
			cstage.removeChild(curMove.runningSprite);
			if (curMove.doShake) {
				curMove.doShake = false;
				curMove.endTime = .3+seconds();
				curMove.type = 3;
			}
			else {
				curMove.type = 4;
				playerTurn = !playerTurn;
				if (playerTurn) {
					showCombatUi(true);
					//Check for player death which shows overlay
					if (userData.health <= 0) {
						onPlayerDeath();
						return;
					}
				}
				else {
					doAiChoice();
				}
				
			}
		}
	}
}

function startCombat(enemyId) {
	enemy = genEnemy(enemyId);
	comEnemy = new createjs.Bitmap(loader.getResult("e" + enemyId));
	
	//Initialize stat bonuses to zeor
	for (var i = 0; i < statBonus.length; i++)
		statBonus[i] = 0;
	
	//always starts with player's turn
	playersTurn = true;
	showCombatUi(true);
	
	//Update now
	lastUpdateAt = seconds();
	
	//Set positions
	playerTurn = true;
	
	//Start idle
	curMove.type = 4;

	var size = comEnemy.getBounds();
	comEnemy.setTransform(enemyX,battleY,50/size.width,50/size.height);
	
	cstage.addChild(comEnemy);
	
	//Setup enemy picture
	enemyui.username.text = allEnemies.friend[enemyId].name;
	enemyui.username.x = enemyui.x + enemyui.width/2 - enemyui.username.getMeasuredWidth()/2;
	
	cstage.removeChild(enemyui.userpic); 
	enemyui.userpic = new createjs.Bitmap(loader.getResult("e"+enemyId))
	enemyui.userpic.setTransform(enemyui.x+enemyui.width/2-50/2,enemyui.y+enemyui.height/20*3,50/size.width,50/size.height);
	cstage.addChild(enemyui.userpic);
	
}

function sendAttackFromAI(assetName,damage) {
	//Decrease the player's cooldown
	abilCooldown--;
	if (abilCooldown < 0)
		abilCooldown = 0;
	
	//Start attack
	comEffect = new createjs.Bitmap(loader.getResult(assetName));
	var size = comEffect.getBounds();
	comEffect.setTransform(enemyX+50,battleY,20/size.width,20/size.height);
	//Move comeffec to an attack location
	//comEffect.x = playerX;
	//comEffect.y = battleY;
	
	cstage.addChild(comEffect);
	curMove.runningSprite = comEffect;
	
	//Types:
	// 0 means projectile going towards player
	// 1 means projectile going towards enemy
	// 2 means effect running for the duration
	// 3 means do shake effect
	// 4 means nothing
	curMove = {
		//The various types of current moves
		type : 1,
		runningSprite : comEffect,
		endTime : seconds()+.5,
		//At the end of the current effect do the shake
		//effect
		doShake : true,
		
		//If effectsEnemy is true, damageAtEnd/healthAtEnd effects enemy
		//else effects player
		effectsEnemy : false,
		damageAtEnd : damage,
		healthAtEnd : 0,
	};
}

function doAiChoice() {
	if (enemy.health <= 0) {
		enemy.health = 0;
		setCombatStatus(false);
		userData.xp += lvlFromXp(userData.xp)*3+5;
		savegame();
		
		cstage.removeChild(enemyui.userpic);
		cstage.removeChild(comEnemy);
		
		return;
	}
	
	//showCombatUi(true);
	//console.log("Enemy damage: " + enemy.atk);
	sendAttackFromAI("pokeright",enemy.atk);
}


function sendAttackFromPlayer(assetName,damage) {
	//Start attack
	comEffect = new createjs.Bitmap(loader.getResult(assetName));
	var size = comEffect.getBounds();
	comEffect.setTransform(playerX,battleY,20/size.width,20/size.height);
	//Move comeffec to an attack location
	//comEffect.x = playerX;
	//comEffect.y = battleY;
	
	cstage.addChild(comEffect);
	curMove.runningSprite = comEffect;
	
	//Types:
	// 0 means projectile going towards player
	// 1 means projectile going towards enemy
	// 2 means effect running for the duration
	// 3 means do shake effect
	// 4 means nothing
	curMove = {
		//The various types of current moves
		type : 1,
		runningSprite : comEffect,
		endTime : seconds()+.5,
		//At the end of the current effect do the shake
		//effect
		doShake : true,
		
		//If effectsEnemy is true, damageAtEnd/healthAtEnd effects enemy
		//else effects player
		effectsEnemy : true,
		damageAtEnd : damage,
		healthAtEnd : 0,
	};
}

function doItemSizeEffect(assetName) {
	showCombatUi(false);
	//Start attack
	comEffect = new createjs.Bitmap(loader.getResult(assetName));
	var size = comEffect.getBounds();
	comEffect.scale = 3;
	comEffect.setTransform(playerX,battleY,comEffect.scale,comEffect.scale);
	
	cstage.addChild(comEffect);
	curMove.runningSprite = comEffect;
	
	//Types:
	// 0 means projectile going towards player
	// 1 means projectile going towards enemy
	// 2 means effect running for the duration
	// 3 means do shake effect
	// 4 means nothing
	curMove = {
		//The various types of current moves
		type : 5,
		runningSprite : comEffect,
		endTime : seconds()+.75,
		//At the end of the current effect do the shake
		//effect
		doShake : false,
		
		//If effectsEnemy is true, damageAtEnd/healthAtEnd effects enemy
		//else effects player
		effectsEnemy : true,
		damageAtEnd : 0,
		healthAtEnd : 0,
	};
}

//Build an item event
function buildItemButton(item) {
return makebutton("",false,function(){
	//userData.items[world[pos.x][pos.y].itemType]++;
	//world[pos.x][pos.y] = null;
	
	//Don't use items you don't have
	if (userData.items[item] <= 0)
		return;
	else
		userData.items[item]--;
	
	switch(item) {
	case 0:
		user.stats.str-=3;
		user.stats.int+=3;
		updateStats(user.stats,[user.stats.str,user.stats.agi,user.stats.int]);
		doItemSizeEffect("item_coffee");
		break;
	case 1:
		user.stats.str+=3;
		user.stats.int-=3;
		updateStats(user.stats,[user.stats.str,user.stats.agi,user.stats.int]);
		doItemSizeEffect("item_alcohol");
		break;	
	case 2:
		userData.health += 50;	
		doItemSizeEffect("item_pizza");
		break;
	case 3:
		user.stats.def+=10;	
		doItemSizeEffect("item_firewall");
		break;
	case 4:
		sendAttackFromPlayer("zeroone",150);
		showCombatUi(false);
		break;
	}
	
});
}

//Called once in the init()
function initCombatSprites() {
	abilCooldown = 0;
	//player sprite
	comPlayer = new createjs.Bitmap(loader.getResult("user"));
	var size = comPlayer.getBounds();
	comPlayer.setTransform(playerX,battleY,50/size.width,50/size.height);
	
	cstage.addChild(comPlayer);
	
	attackButton = makebutton("Attack",true,function() {
		//Disable your control
		showCombatUi(false);
		
		sendAttackFromPlayer("poke",user.stats.sp);
	});
	abilityButton = makebutton(abilities[user.class].name,true,function() {
		abilCooldown = 5;
		switch (user.class) {
			
			case 0:
				doItemSizeEffect("item_script");
				userData.items[4] += 2;
				showCombatUi(false);
				break;
			case 1:
				sendAttackFromPlayer("syringe",user.stats.sp*1.8);
				showCombatUi(false);
				break;
			case 2:
				curMove.doShake = true;
				curMove.effectsEnemy = true;
				curMove.type = 2;
				enemy.atk -= user.stats.sp/10;
				if (enemy.atk < 0)
					enemy.atk = 0;
				showCombatUi(false);
				break;
		}
	});
	
	for (var i = 0; i < itemTypes.length; i++) {
			var extraHeight = (i >= 3) ? 50 : 0;
			var curW = 0;
			var curH = 0;
			if (i >= 3) {
				curH = ui.height/20*15 + 60;
				curW = ui.x+60+(i-3)*50;
			}
			else {
				curH = ui.height/20*15;
				curW = ui.x+40+i*50;
			}
			
			var b = buildItemButton(i);
			b.x = curW;
			b.y = curH;
			b.width = 30;
			b.height = 30;
			itemButtons[i] = b;
		}
	
	
	attackButton.x = w/2-100/2;
	attackButton.y = 300;
	abilityButton.width = 200;
	abilityButton.x =w/2-200/2;
	abilityButton.y = 350;
}

